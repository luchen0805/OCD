---
title             : "Prevalence of OCD in different patient groups"
short title       : "OCD patients information analysis"

author: 
  - name          : "Luchen Yu"
    affiliation   : "University of Chicago"
    email         : "ylc23@uchicago.edu"

  <!-- https://tinyurl.com/ybremelq -->
  
keywords          : "keywords"
wordcount         : "X"

bibliography      : "r-references.bib"

floatsintext      : no
linenumbers       : yes
draft             : no
mask              : no

figurelist        : no
tablelist         : no
footnotelist      : no

classoption       : "man"
output            : papaja::apa6_pdf
---

```{r setup, include = FALSE}
# load papaja package
library("papaja")
source("R code.R",local = knitr::knit_global())
r_refs("r-references.bib")
```

```{r helloworld, include = FALSE}
# call hello_world function
source("functions.R", local = knitr::knit_global())
```

```{r read OCDdata}
# load readr package
library(readr)

# read in the dataset
OCD.data <- read.csv("ocd_patient_dataset.csv")

# examine the dataset
str(OCD.data)

# each column is either a character or numeric number
# each row is a single observation for one patient
# each cell is a single measurement
# for research questions about the association of the prevalence of OCD with education level, family history of OCD, and previously diagnosed disorders, only the column "Education Level", "Family History of OCD", and "Previous Diagnoses" are needed, all the other columns are extraneous
```

```{r intermediate OCDdata}
# create an intermediate dataset
# select specific columns that are related to my research questions
library(dplyr)
select(OCD.data, Education.Level, Family.History.of.OCD, Previous.Diagnoses)

# keep rows based on certain column values
# High school as education level, has family history of OCD, and does not be previously diagnosed
filter(OCD.data, Education.Level == "High School" & Family.History.of.OCD == "Yes" & Previous.Diagnoses == "None")

# combine the two
# intermediate dataset for High school educated patients with family history of OCD and does not be diagnosed with other disorders before
intermediate.OCD.data <- OCD.data %>%
  select(Education.Level, Family.History.of.OCD, Previous.Diagnoses) %>%
  filter(Education.Level == "High School" & Family.History.of.OCD == "Yes" & Previous.Diagnoses == "None")

# write into csv filetype
csv_file_path <- "intermediate_ocd_data.csv"
write.csv(intermediate.OCD.data, csv_file_path)
```

```{r plots plan}
## For the first plot, I plan to create a bar plot for the prevalence of OCD among individuals with 4 education level groups, to address the first research question "Is there a significant difference in the prevalence of OCD among individuals with varying levels of education?". And then I will use ANOVA/t-test to assess whether the differences in OCD prevalence across education levels are statistically significant. To create the plot, I will use the Education Level column to calculate the percentage of individuals within each education level group. Each education level group has a corresponding bar, and the height of the bar represents the prevalence of OCD in that group. X-axis is for education level groups; Y-axis is for prevalence of OCD.
library(ggplot2)
ggplot(data, aes(x = Education.Level)) +
  geom_bar()
# from today's class, this bar plot is meaningless, i will calculate the frequency and consider to use a boxplot

# calculate frequency of each education level
education_table <- table(data$Education.Level)
education_table

# calculate proportion of each education level
proportion_education_level <- prop.table(education_table)
proportion_education_level

## For the second plot, I plan to create a pie chart for the distribution of individuals with and without a family history of OCD, to address the second research question "Does the family history of OCD contribute to the development of the OCD disorder?". And then I will use logistic regression/chi-square test to assess the statistical significance of the association. To create the plot, I will use the Family history of OCD column to calculate the percentage of individuals in either group. Then, proportion is represented by the area in the chart.

# calculate frequency of with/without family history
family_history_table <- table(data$Family.History.of.OCD)
family_history_table

# calculate proportion
proportion_family_history <- prop.table(family_history_table)
proportion_family_history

# draw
pie(proportion_family_history, labels = data$Family.History.of.OCD, main = "Family history of OCD distribution")

```


```{r analysis-preferences}
# Seed for random number generation
set.seed(42)
knitr::opts_chunk$set(cache.extra = knitr::rand_seed)
```

# **Introduction**



<!-- Ordered list -->
I will analyze these three research questions below.  
1. Is there a significant difference in the prevalence of OCD among individuals with varying levels of education?  
2. Does the family history of OCD contribute to the development of the OCD disorder?  
3. Are patients previously diagnosed with other disorders more likely to develop OCD?

<!-- Unordered list -->
I will analyze from three aspects.  
* Association of education level with prevalence of OCD.  
* Association of family history of OCD with prevalence of OCD.  
* Association of previously diagnosed disorders with prevalence of OCD.  

<!-- Linked URL -->
[My GitHub](https://github.com/luchen0805/OCD)

# **Methods**

# **Data analysis**
We used `r cite_r("r-references.bib")` for all our analyses.

## ***Association of education level with prevalence of OCD***

### Is there a significant difference

## ***Association of family history of OCD with prevalence of OCD***

## ***Impact of previously diagonsed disorders on prevalence of OCD***

# **Results**

# **Discussion**


\newpage

# **References**

::: {#refs custom-style="Bibliography"}
:::
